

  --------- capitulo 07 - sub-consultas

  ---

  SELECT COD_CONTRATO, DATA , TOTAL
  FROM TCONTRATO
  WHERE TOTAL >
  (SELECT VALOR FROM TCURSO
    WHERE COD_CURSO = 6);


  ---- Errado(sÃ³ pode retornar )
  ---- linha na subconsulta)

  SELECT COD_CONTRATO, DATA, TOTAL
  FROM TCONTRATO
  WHERE TOTAL >=
   (SELECT VALOR FROM TCURSO
  WHERE  VALOR > 500) ;


  ------ TODOS OS ALUNOS DA MESMA CIDADE DO ALUNO
  --- MENOS O ALUNOS

  SELECT COD_ALUNO, NOME,CIDADE
  FROM TALUNO
  WHERE CIDADE = (SELECT CIDADE FROM TALUNO
  WHERE COD_ALUNO =5)
  AND COD_ALUNO <>5;

  ---- TODOS OS ALUNOS DA MESMA CIDADE E
  --- ESTADO DO ALUNO
  --MENOS O ALUNO

  SELECT COD_ALUNO, NOME, CIDADE, ESTADO
  FROM TALUNO
  WHERE (CIDADE, ESTADO ) =
                          (SELECT CIDADE, ESTADO FROM TALUNO
                          WHERE COD_ALUNO = 1)
                          AND COD_ALUNO <> 1;

  -----SOMA TODOS OS ITENS, E MOSTRA SOMENTE CUJO O
  ----O VALOR MINIMO SEJA MAIOR QUE O VALOR MEDIO
  --- DOS CURSOS


  SELECT COD_CURSO, Min( VALOR )AS VALOR_MINI, Sum(VALOR)AS SOMA_VALOR,
  Count(*) QTD
  FROM TITEM
  WHERE COD_curso >0
  GROUP BY cod_curso
  HAVING Min(valor) >
                (SELECT Avg (VALOR) FROM TCURSO)
                ORDER BY COD_CURSO;

 -------SOMA O TOTAL DE CONTRATOS POR ALUNO E MOSTRA
 -------SOMENTE CUJO O MENOR CONTRATO SEJA MAIOR QUE
 -------O VALOR MEDIO DE CURSO

  SELECT COD_ALUNO, Min(TOTAL), Sum(TOTAL)
  FROM TCONTRATO
  GROUP BY COD_ALUNO
  HAVING Min(TOTAL) >
  (SELECT Avg(VALOR) FROM TCURSO);



